{"version":3,"file":"role.guard.js","sourceRoot":"","sources":["../../../../src/lib/guards/role.guard.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,eAAe,CAAC;AACvC,OAAO,EAAE,MAAM,EAAiB,MAAM,iBAAiB,CAAC;AACxD,OAAO,EAAE,WAAW,EAAE,MAAM,0BAA0B,CAAC;AAEvD;;;GAGG;AACH,MAAM,UAAU,SAAS,CAAC,YAAsB;IAC9C,OAAO,CAAC,KAAK,EAAE,KAAK,EAAE,EAAE;QACtB,MAAM,WAAW,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC;QACxC,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;QAE9B,MAAM,IAAI,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC;QAEhC,IAAI,CAAC,IAAI,EAAE,CAAC;YACV,MAAM,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;YAC5B,OAAO,KAAK,CAAC;QACf,CAAC;QAED,IAAI,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;YACrC,OAAO,IAAI,CAAC;QACd,CAAC;QAED,kCAAkC;QAClC,MAAM,CAAC,QAAQ,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;QACnC,OAAO,KAAK,CAAC;IACf,CAAC,CAAC;AACJ,CAAC","sourcesContent":["import { inject } from '@angular/core';\nimport { Router, CanActivateFn } from '@angular/router';\nimport { AuthService } from '../services/auth.service';\n\n/**\n * Role Guard Factory - Protects routes based on user role\n * Usage: { path: 'admin', component: AdminComponent, canActivate: [roleGuard(['Admin'])] }\n */\nexport function roleGuard(allowedRoles: string[]): CanActivateFn {\n  return (route, state) => {\n    const authService = inject(AuthService);\n    const router = inject(Router);\n\n    const user = authService.user();\n\n    if (!user) {\n      router.navigate(['/login']);\n      return false;\n    }\n\n    if (allowedRoles.includes(user.role)) {\n      return true;\n    }\n\n    // User doesn't have required role\n    router.navigate(['/unauthorized']);\n    return false;\n  };\n}"]}